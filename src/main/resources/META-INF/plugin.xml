<idea-plugin url="https://github.com/lukaskremla/micropython-tools-jetbrains">
    <name>MicroPython Tools</name>
    <id>micropython-tools-jetbrains</id>

    <change-notes><![CDATA[
        <h3>0.6.0 - xx-8-2025</h3>
        <ul>
            <li></li>
        </ul>
        <br>
        <p>Previous versions can be found in <a href="https://github.com/lukaskremla/micropython-tools-jetbrains/blob/main/CHANGES.md">CHANGES.md</a> on GitHub</p>
    ]]></change-notes>

    <description><![CDATA[
        <p>Adds support for working with MicroPython devices to PyCharm.</p>
        <p>Features:</p>
        <ul>
            <li>Efficiently upload files to MPY boards (Serial, WebREPL)</li>
            <li>Comfortably view and interact with the board's file system with drag and drop support</li>
            <li>Built-in stub manager utilizing stubs by <a href="https://github.com/Josverl/micropython-stubs">Jos Verlinde</a></li>
            <li>Upload preview dialog that shows how the file system will look after the upload</li>
            <li>Observe code execution through REPL</li>
        </ul>
        <p>All microcontrollers and MicroPython versions above 1.20.0 should be supported. However, certain features might not be available on highly resource constrained microcontrollers such as the ESP8266.</a></p>
        <p>Feedback and bug reports through GitHub are welcome!</p>
        <p>More info and usage tips <a href="https://github.com/lukaskremla/micropython-tools-jetbrains">on GitHub!</a></p>
    ]]></description>

    <version>SNAPSHOT</version>
    <vendor>Lukas Kremla</vendor>

    <dependencies>
        <plugin id="com.intellij.modules.lang"/>
        <plugin id="com.intellij.modules.python"/>
        <plugin id="com.intellij.modules.platform"/>
        <plugin id="org.jetbrains.plugins.terminal"/>
    </dependencies>

    <idea-version since-build="243"/>

    <resource-bundle>localization.MpyBundle</resource-bundle>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Settings -->
        <projectConfigurable groupId="language"
                             id="dev.micropythontools.configurable"
                             key="configurable.name"
                             bundle="localization.MpyBundle"
                             instance="dev.micropythontools.settings.MpyConfigurable"/>

        <!-- File handling -->
        <fileEditorProvider implementation="dev.micropythontools.mpyfile.MpyFileEditorProvider"/>
        <fileType name="MicroPython Bytecode"
                  implementationClass="dev.micropythontools.mpyfile.MpyFileType"
                  extensions="mpy"/>

        <!-- Inspections -->
        <!--suppress PluginXmlCapitalization -->
        <localInspection language="Python"
                         key="inspection.name"
                         groupKey="inspection.group.name"
                         bundle="localization.MpyBundle"
                         enabledByDefault="true"
                         implementationClass="dev.micropythontools.inspections.MpyStubPackageInspection"/>

        <!-- Inspections -->
        <!--suppress PluginXmlCapitalization -->
        <localInspection language="Python"
                         key="inspection.name"
                         groupKey="inspection.group.name"
                         bundle="localization.MpyBundle"
                         enabledByDefault="true"
                         implementationClass="dev.micropythontools.inspections.MpyPythonInspection"/>

        <!-- Notifications -->
        <!--suppress PluginXmlCapitalization -->
        <notificationGroup displayType="BALLOON"
                           id="dev.micropythontools.notification.group"
                           key="notification.group.name"
                           bundle="localization.MpyBundle"/>

        <!-- Run configurations -->
        <configurationType implementation="dev.micropythontools.run.MpyRunConfType"/>

        <!-- UI elements -->
        <toolWindow factoryClass="dev.micropythontools.ui.MpyToolWindow"
                    id="MicroPython Tools"
                    anchor="bottom"
                    canCloseContents="false"/>

        <!-- Source roots -->
        <projectStructure.sourceRootEditHandler
                implementation="dev.micropythontools.sourceroots.MpyModuleMpySourceRootEditHandler"/>

        <!-- Startup tasks -->
        <postStartupActivity implementation="dev.micropythontools.startup.MpyConfigurationMigrationActivity"/>

        <!-- Editor notifications -->
        <editorNotificationProvider implementation="dev.micropythontools.editor.MpyEditorNotificationProvider"/>
    </extensions>

    <applicationListeners>
        <listener topic="com.intellij.openapi.actionSystem.ex.AnActionListener"
                  class="dev.micropythontools.listeners.MpySaveKeyListener"/>
    </applicationListeners>

    <actions>
        <!-- FS toolbar -->
        <group id="dev.micropythontools.fs.FSToolbarGroup">
            <action id="dev.micropythontools.repl.MpyConnectAction"
                    class="dev.micropythontools.actions.MpyConnectAction"/>
            <action id="dev.micropythontools.repl.MpyDisconnectAction"
                    class="dev.micropythontools.actions.MpyDisconnectAction">
                <keyboard-shortcut first-keystroke="control CLOSE_BRACKET" keymap="$default"/>
            </action>
            <action id="dev.micropythontools.repl.MpyConnectionSelectorAction"
                    class="dev.micropythontools.actions.MpyConnectionSelectorAction"/>
            <action id="dev.micropythontools.fs.MpyRefreshAction"
                    class="dev.micropythontools.actions.MpyRefreshAction">
                <keyboard-shortcut first-keystroke="control R" keymap="$default"/>
            </action>
            <action id="dev.micropythontools.fs.MpyDownloadAction"
                    class="dev.micropythontools.actions.MpyDownloadAction"/>
            <action id="dev.micropythontools.fs.MpyDeleteAction"
                    class="dev.micropythontools.actions.MpyDeleteAction"
                    use-shortcut-of="$Delete"/>
            <action id="dev.micropythontools.repl.MpyOpenSettingsAction"
                    class="dev.micropythontools.actions.MpyOpenSettingsAction"/>
            <action id="dev.micropythontools.repl.MpyAutoClearAction"
                    class="dev.micropythontools.actions.MpyAutoClearAction"/>
        </group>

        <!-- FS context menu -->
        <group id="dev.micropythontools.fs.FSContextMenuGroup">
            <group id="dev.micropythontools.fs.MpyNewActionGroup"
                   class="dev.micropythontools.actions.MpyNewActionGroup">
            </group>

            <separator/>

            <reference ref="$Cut"/>
            <reference ref="$Copy"/>
            <group id="dev.micropythontools.fs.MpyCopyPathActionGroup"
                   class="dev.micropythontools.actions.MpyCopyPathActionGroup">
            </group>

            <reference ref="$Paste"/>

            <separator/>

            <action id="dev.micropythontools.fs.MpyRenameAction"
                    class="dev.micropythontools.actions.MpyRenameAction"
                    use-shortcut-of="RenameElement"/>

            <separator/>

            <action id="dev.micropythontools.fs.MpyOpenFileAction"
                    class="dev.micropythontools.actions.MpyOpenFileAction"/>
            <reference ref="dev.micropythontools.fs.MpyRefreshAction"/>
            <reference ref="dev.micropythontools.fs.MpyDownloadAction"/>

            <separator/>

            <reference ref="dev.micropythontools.fs.MpyDeleteAction"/>
        </group>

        <!-- REPL toolbar -->
        <group id="dev.micropythontools.repl.ReplToolbarGroup">
            <reference ref="dev.micropythontools.repl.MpyConnectAction"/>
            <reference ref="dev.micropythontools.repl.MpyDisconnectAction"/>
            <reference ref="dev.micropythontools.repl.MpyConnectionSelectorAction"/>
            <action id="dev.micropythontools.repl.MpySoftResetAction"
                    class="dev.micropythontools.actions.MpySoftResetAction">
                <keyboard-shortcut first-keystroke="control D" keymap="$default"/>
            </action>
            <action id="dev.micropythontools.repl.MpyInterruptAction"
                    class="dev.micropythontools.actions.MpyInterruptAction"/>
            <action id="dev.micropythontools.repl.MpyClearReplAction"
                    class="dev.micropythontools.actions.MpyClearReplAction"/>
            <reference ref="dev.micropythontools.repl.MpyOpenSettingsAction"/>
            <reference ref="dev.micropythontools.repl.MpyAutoClearAction"/>
        </group>

        <!-- Upload actions -->
        <group id="dev.micropythontools.repl.MpyUploadActionGroup"
               class="dev.micropythontools.actions.MpyUploadActionGroup">
            <add-to-group group-id="EditorPopupMenu" anchor="before" relative-to-action="ExecuteInPyConsoleAction"/>
            <add-to-group group-id="EditorTabPopupMenu" anchor="last"/>
            <add-to-group group-id="ProjectViewPopupMenuSettingsGroup" anchor="last"/>
        </group>

        <action id="dev.micropythontools.repl.MpyUploadProjectAction"
                class="dev.micropythontools.actions.MpyUploadProjectAction">
            <add-to-group group-id="ProjectViewPopupMenuSettingsGroup" anchor="last"/>
        </action>

        <action id="dev.micropythontools.repl.MpyExecuteFileInReplAction"
                class="dev.micropythontools.actions.MpyExecuteFileInReplAction">
            <add-to-group group-id="EditorPopupMenu"
                          anchor="before"
                          relative-to-action="dev.micropythontools.repl.MpyUploadActionGroup"/>
            <add-to-group group-id="EditorTabPopupMenu"
                          anchor="before"
                          relative-to-action="dev.micropythontools.repl.MpyUploadActionGroup"/>
            <add-to-group group-id="ProjectViewPopupMenuSettingsGroup"
                          anchor="before"
                          relative-to-action="dev.micropythontools.repl.MpyUploadActionGroup"/>
        </action>

        <action id="dev.micropythontools.repl.MpyExecuteFragmentInReplAction"
                class="dev.micropythontools.actions.MpyExecuteFragmentInReplAction">
            <add-to-group group-id="EditorPopupMenu"
                          anchor="before"
                          relative-to-action="dev.micropythontools.repl.MpyExecuteFileInReplAction"/>
        </action>

        <!-- Source root marking -->
        <group id="dev.micropythontools.sourceroots.MarkMpySourceRootGroup">
            <action id="dev.micropythontools.sourceroots.MarkMpySourceRootAction"
                    class="dev.micropythontools.sourceroots.MarkMpySourceRootAction"/>
            <add-to-group group-id="MarkRootGroup"/>
        </group>
    </actions>
</idea-plugin>